·layout: post

date: 2015-03-10 19:07:43

comments: true

categories: Blog

tags:
	- iOS
	- Debug

title: facebook 的lldb来调试一
---
本来一直想给大家普及一下lldb的使用，因为身边有很多朋友虽然开发了很久，但是还是不会使用调试器，还傻傻的打一个log,重启程序再看这个值。说，是不是你，中招没。这一篇也是为了帮这些朋友认识一下调试器的强大。整篇介绍的例子都是基于我的贴图demo的。

### 1.首先介绍下如何避免重启程序打一个log

如图下：
![lldbLog](http://m2.img.srcdd.com/farm4/d/2015/0212/11/C27AE564FFD6FE8FC899F68DED134DD7_ORIG_1733_926.gif)

* 1.首先注释以前那该死的log背景被点击了，然后我加一个优美的断点。
* 2.然后右键点击断点编辑断点，首先选择Action,logMessage，再点击+,选择DebugerCommander，然后这里面的命令和右下角的lldb命令是完全一样的，这个命令你随意打。
* 3.最重要的一步，一点要选择 automatically continue after evaluating value，这个可以使得程序不会中断继续执行。

好吧，大家以后就可以告别这个该死的log,以后大家的consle就不出现那些乱七八糟的log,而且还找不到了.我现在就是每次看到项目里一堆log就特别烦……（ps:这个……是shift+6打出来的哦）,所以只要你想在输出某一个值或者一句话看一个函数，是否调用，完全不需要多余的重新运行一次程序。

### 2基本的lldb命令的介绍
大家一般知道的lldb命令一般是p,和po,其实我研究了一阵子最实用的也就这两个lldb命令，但是大家一般都不知道用在什么场合。

* p命令的介绍，首先p是打印非对象的值，它是 e --的缩写。如果使用它打印对象的话，那么它会打印出对象的地址，如果打印非对象它一般会打印出基本变量类型的值。当然用它也可以申明一个变量譬如 p int $a = 10; （注lldb使用$在变量前来声明为lldb内的命名空间的）
* po 命令，po 命令是我们最常用的命令因为在ios开发中，我们时刻面临着对象（ps:但是我没有对象，欢迎介绍），所以我们在绝大部分时候都会使用po。首先po这个命令会打印出对象的description描述。

好吧，MacDown语法还是没有完全搞明白，所以篇幅不是太好看（这个完全没想这么早出这篇博客）

下面还是使用一副图片来描述具体的过程吧。

![po的使用](http://m3.img.srcdd.com/farm4/d/2015/0212/13/E505902B1D8D75A1B63C5611BF482417_ORIG_1490_964.gif)

* 首先我在背景蒙层下了个断点，程序中断之后，我首先通过po 命令打出了【po self.view】然后打出了当前的self.view的描述。
* 然后我通过self.view的description描述，然后找到手势NSArry的地址我打印出了当前view上面有那些手势。
* 然后找到当前pinch的手势，然后通过p 命令，将其强转成UIPinchGesture,因为lldb有时无法确定其具体的类型，需要强转，但是这个强转不是必须的，需要你们自己根据情况来决定。
* 当我们使用p 命令打印一个对象时，lldb内部会默认使用一个$加数字来记录这个对象。
* 这个$会一直存在，当这个对象还没销毁的时候，所以我们随时可以通过这个变量来打印以前的值。我是通过[$61 view]找出pinch 作用的view.我们也可以使用p命令得到一个这个view在lldb的记录。


注意在使用lldb内部的变量$来记录变量的时候，绝大部分的时候都没有语法提示，所以你需要自己能准确的打印出方法的名字。我这里一般，都是在当前编辑器中去打好方法，然后再拷贝到lldb处。

在使用lldb命令的时候，并非所有的命令都很常用，你可以通过在lldb中 打印 help 查看所有的lldb命令，譬如breakpoint命令，这种命令完全可以通过Xcode UI界面加断点，当然所有的xcode ui 界面加断点本质也是通过lldb的命令的，这个一般用户都不会太常用。

![help命令](http://m2.img.srcdd.com/farm4/d/2015/0212/13/2D9F83BA11E4F162D239E1742B7A4E3D_B500_900_500_634.png)



今天就先介绍到这里，下一篇博客我会介绍给大家如何使用开源的facebook的[chisel](https://github.com/facebook/chisel),从安装到以及在什么场景下使用什么命令，和常用的chisel命令有哪些。因为这个MarkDown还没弄太熟悉，所以重头戏在下一章。（ps:主要是markDown还没用熟，我自己看着都不爽，所以下次会带来更好的版本，和更详细的介绍）
